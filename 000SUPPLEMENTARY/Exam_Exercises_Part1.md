# OS - Exercises, Diagrams and Exam Questions

## Part 1: Weeks 1-4

> by Revolvix | ASE Bucharest - CSIE

---

# WEEK 1: Introduction to OS

## Detailed ASCII Diagrams

### Diagram 1.1: Layers of a Computing System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                         â”‚
â”‚    ğŸ‘¤ USER                                                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚  Interface: CLI (bash), GUI (GNOME), Voice, Touch               â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                        â”‚
â”‚                                 â–¼                                        â”‚
â”‚    ğŸ“¦ APPLICATIONS                                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  Browser â”‚ Editor â”‚ Compiler   â”‚ Games  â”‚ Office â”‚ Media      â”‚   â”‚
â”‚    â”‚  Chrome  â”‚ VSCode â”‚ gcc        â”‚ Steam  â”‚ Libre  â”‚ VLC        â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚                                        â”‚
â”‚                                 â”‚ System Calls                           â”‚
â”‚                                 â”‚ (read, write, fork, exec...)           â”‚
â”‚                                 â–¼                                        â”‚
â”‚    ğŸ–¥ï¸ OPERATING SYSTEM                                                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚                    KERNEL                                 â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚  Process   â”‚ â”‚  Memory    â”‚ â”‚   File     â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚  Manager   â”‚ â”‚  Manager   â”‚ â”‚   System   â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚            â”‚ â”‚            â”‚ â”‚            â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ scheduler  â”‚ â”‚ paging     â”‚ â”‚ ext4, VFS  â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ fork/exec  â”‚ â”‚ virtual    â”‚ â”‚ inodes     â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ signals    â”‚ â”‚ allocation â”‚ â”‚ dirs       â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚   I/O      â”‚ â”‚  Network   â”‚ â”‚  Security  â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚  Manager   â”‚ â”‚   Stack    â”‚ â”‚  Module    â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚            â”‚ â”‚            â”‚ â”‚            â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ drivers    â”‚ â”‚ TCP/IP     â”‚ â”‚ SELinux    â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ buffering  â”‚ â”‚ sockets    â”‚ â”‚ AppArmor   â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â”‚ scheduling â”‚ â”‚ firewall   â”‚ â”‚ cgroups    â”‚           â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚                                        â”‚
â”‚                                 â”‚ Hardware Abstraction Layer (HAL)       â”‚
â”‚                                 â”‚ Device drivers                         â”‚
â”‚                                 â–¼                                        â”‚
â”‚    âš™ï¸ HARDWARE                                                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚   CPU   â”‚ â”‚   RAM   â”‚ â”‚  Disk   â”‚ â”‚   GPU   â”‚ â”‚ Network â”‚  â”‚   â”‚
â”‚    â”‚  â”‚ 8 cores â”‚ â”‚  16GB   â”‚ â”‚ 1TB SSD â”‚ â”‚  RTX    â”‚ â”‚  1Gbps  â”‚  â”‚   â”‚
â”‚    â”‚  â”‚ 3.6GHz  â”‚ â”‚ DDR5    â”‚ â”‚ NVMe    â”‚ â”‚  4070   â”‚ â”‚  eth0   â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚    â”‚  â”‚Keyboard â”‚ â”‚  Mouse  â”‚ â”‚ Display â”‚ â”‚  Audio  â”‚ â”‚   USB   â”‚  â”‚   â”‚
â”‚    â”‚  â”‚  HID    â”‚ â”‚  HID    â”‚ â”‚ HDMI/DP â”‚ â”‚ ALSA    â”‚ â”‚  3.2    â”‚  â”‚   â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Diagram 1.2: Evolution of Operating Systems

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    TIMELINE - OS EVOLUTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1950        1960        1970        1980        1990        2000        2010
  â”‚           â”‚           â”‚           â”‚           â”‚           â”‚           â”‚
  â–¼           â–¼           â–¼           â–¼           â–¼           â–¼           â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERATION 1: No OS (1945-1955)                                         â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                         â”‚
â”‚                                                                         â”‚
â”‚   [Punched cards] â”€â”€â–º [Computer] â”€â”€â–º [Printer]                         â”‚
â”‚                                                                         â”‚
â”‚   â€¢ Machine code programming                                            â”‚
â”‚   â€¢ One programme at a time                                             â”‚
â”‚   â€¢ Fully manual operation                                              â”‚
â”‚   â€¢ CPU utilisation: ~30%                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERATION 2: Batch Processing (1955-1965)                              â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                              â”‚
â”‚                                                                         â”‚
â”‚   [Job 1]â”€â”                                                            â”‚
â”‚   [Job 2]â”€â”¼â”€â”€â–º [Batch Monitor] â”€â”€â–º [Execution] â”€â”€â–º [Output]            â”‚
â”‚   [Job 3]â”€â”˜                                                            â”‚
â”‚                                                                         â”‚
â”‚   â€¢ GM-NAA I/O (1956) - the first OS                                   â”‚
â”‚   â€¢ Automatic transition between jobs                                   â”‚
â”‚   â€¢ CPU utilisation: ~90%                                               â”‚
â”‚   â€¢ No interactivity                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERATION 3: Multiprogramming & Time-Sharing (1965-1980)               â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   â”‚  CPU Timeline                            â”‚                         â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”         â”‚                         â”‚
â”‚   â”‚  â”‚ A â”‚â”‚ B â”‚â”‚ C â”‚â”‚ A â”‚â”‚ B â”‚â”‚ C â”‚ ...     â”‚                         â”‚
â”‚   â”‚  â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜         â”‚                         â”‚
â”‚   â”‚        Time Quantum (e.g. 100ms)         â”‚                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                         â”‚
â”‚   â€¢ CTSS (1961), Multics (1969), UNIX (1969)                          â”‚
â”‚   â€¢ Multiple users simultaneously                                       â”‚
â”‚   â€¢ Illusion of parallelism                                            â”‚
â”‚   â€¢ Interactivity!                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERATION 4: PC & GUI (1980-2000)                                      â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                      â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                      â”‚
â”‚   â”‚  â”‚ ğŸ“ File  ğŸ“ Edit  ğŸ‘ View  â“ Help â”‚   â”‚  GUI                   â”‚
â”‚   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚                      â”‚
â”‚   â”‚  â”‚  ğŸ“‚ Documents                        â”‚   â”‚                      â”‚
â”‚   â”‚  â”‚  ğŸ“‚ Pictures                         â”‚   â”‚                      â”‚
â”‚   â”‚  â”‚  ğŸ“„ readme.txt                       â”‚   â”‚                      â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                         â”‚
â”‚   â€¢ MS-DOS (1981), Windows (1985), Mac OS (1984)                       â”‚
â”‚   â€¢ Linux (1991) - Open Source                                         â”‚
â”‚   â€¢ Single user, multitasking                                          â”‚
â”‚   â€¢ GUI becomes standard                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GENERATION 5: Mobile & Cloud (2000-present)                             â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                             â”‚
â”‚                                                                         â”‚
â”‚   ğŸ“± Mobile        â˜ï¸ Cloud              ğŸ³ Containers                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   â”‚ Android â”‚     â”‚    AWS      â”‚       â”‚   Docker    â”‚                â”‚
â”‚   â”‚   iOS   â”‚     â”‚   Azure     â”‚       â”‚ Kubernetes  â”‚                â”‚
â”‚   â”‚         â”‚     â”‚   GCP       â”‚       â”‚             â”‚                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                         â”‚
â”‚   â€¢ iOS (2007), Android (2008)                                         â”‚
â”‚   â€¢ Cloud computing, virtualisation                                     â”‚
â”‚   â€¢ Containers, microservices                                          â”‚
â”‚   â€¢ Edge computing, IoT                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Solved Exercises

### Exercise 1.1: Identifying OS Functions

Task: For each scenario, identify the OS function involved.

| # | Scenario | OS Function | Explanation |
|---|----------|-------------|-------------|
| a | You launch Chrome and Word simultaneously | Process management | OS creates separate processes and schedules execution |
| b | You save a document to disc | File management | OS writes data to the file system |
| c | Chrome cannot read Word's data | Memory protection | OS isolates address spaces |
| d | You read from a USB drive | I/O management | OS communicates with the USB driver |
| e | You authenticate with a password | Security | OS verifies credentials |

---

### Exercise 1.2: OS Classification

Task: Classify the following operating systems and justify.

| OS | Type | Justification |
|----|------|---------------|
| Windows 11 | Desktop, Hybrid | GUI focus, NT hybrid kernel |
| Ubuntu Server | Server, Monolithic | No GUI, monolithic Linux kernel |
| FreeRTOS | RTOS, Embedded | Real-time, for microcontrollers |
| Android | Mobile, Linux-based | Smartphones, modified Linux kernel |
| macOS | Desktop, Hybrid | XNU kernel (Mach microkernel + BSD) |

---

### Exercise 1.3: Batch Processing Calculation

Problem: A batch system processes 5 jobs with the following times:
- Job A: 10 minutes
- Job B: 5 minutes  
- Job C: 15 minutes
- Job D: 8 minutes
- Job E: 12 minutes

Requirements:
1. Calculate the total processing time
2. Calculate the average turnaround time
3. Calculate the average waiting time

Solution:

```
Gantt Chart (FCFS, order A-B-C-D-E):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    A     â”‚  B  â”‚      C        â”‚   D    â”‚     E      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0         10    15              30       38           50

1. Total time = 10 + 5 + 15 + 8 + 12 = 50 minutes

2. Turnaround time (completion - arrival, all arrive at t=0):
   - A: 10 - 0 = 10 min
   - B: 15 - 0 = 15 min
   - C: 30 - 0 = 30 min
   - D: 38 - 0 = 38 min
   - E: 50 - 0 = 50 min
   
   Average = (10 + 15 + 30 + 38 + 50) / 5 = 143 / 5 = 28.6 minutes

3. Waiting time (turnaround - burst):
   - A: 10 - 10 = 0 min
   - B: 15 - 5 = 10 min
   - C: 30 - 15 = 15 min
   - D: 38 - 8 = 30 min
   - E: 50 - 12 = 38 min
   
   Average = (0 + 10 + 15 + 30 + 38) / 5 = 93 / 5 = 18.6 minutes
```

---

## Exam-Style Questions

### Multiple Choice Questions (1 point each)

1.1 Which of the following is NOT a primary function of the OS?
- a) Memory management
- b) Programme compilation âœ“
- c) Process management
- d) I/O management

Answer: b) - The compiler is an application programme, not an OS function.

---

1.2 In what year was UNIX created?
- a) 1956
- b) 1969 âœ“
- c) 1981
- d) 1991

Answer: b) - 1969, by Ken Thompson and Dennis Ritchie at Bell Labs.

---

1.3 Which kernel architecture allows a network driver to crash without affecting the rest of the system?
- a) Monolithic kernel
- b) Microkernel âœ“
- c) Hybrid kernel
- d) Exokernel

Answer: b) - In a microkernel, drivers run in user space as separate servers.

---

### Extended Answer Questions (3-5 points)

1.4 (3p) Explain the difference between monolithic kernel and microkernel, giving an example OS for each.

Model answer:

| Aspect | Monolithic Kernel | Microkernel |
|--------|-------------------|-------------|
| Structure | All kernel code in the same space | Only minimal functions in kernel |
| Components in kernel | Scheduler, MM, FS, drivers | Only IPC, basic scheduling |
| Communication | Direct function calls | Message passing (IPC) |
| Performance | Faster (no IPC overhead) | Overhead for messages |
| Reliability | A bug can crash the entire system | Isolation - components can crash separately |
| Example | Linux, FreeBSD | Minix, QNX, seL4 |

---

1.5 (5p) A batch processing system receives 4 jobs in the order: J1(burst=6), J2(burst=2), J3(burst=8), J4(burst=3). All arrive at t=0.

a) Draw the Gantt chart for FCFS
b) Calculate the average waiting time for FCFS
c) How would it change if we use SJF? Calculate the new average waiting time.
d) What conclusion do you draw?

Model answer:

```
a) FCFS Gantt Chart:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚   J1   â”‚ J2 â”‚    J3    â”‚ J4  â”‚
â”‚   6    â”‚ 2  â”‚    8     â”‚  3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
0        6    8         16    19

b) FCFS Waiting times:
   J1: 0
   J2: 6
   J3: 8
   J4: 16
   Average = (0 + 6 + 8 + 16) / 4 = 30 / 4 = 7.5 minutes

c) SJF (order by burst: J2, J4, J1, J3):
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ J2 â”‚ J4  â”‚   J1   â”‚    J3    â”‚
â”‚ 2  â”‚  3  â”‚   6    â”‚    8     â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0    2     5       11         19

SJF Waiting times:
   J1: 5
   J2: 0
   J3: 11
   J4: 2
   Average = (5 + 0 + 11 + 2) / 4 = 18 / 4 = 4.5 minutes

d) Conclusion: SJF reduces average waiting time from 7.5 to 4.5 minutes 
   (40% reduction), confirming that SJF is optimal for this criterion.
```

---

# WEEK 2: System Calls

## Detailed ASCII Diagrams

### Diagram 2.1: System Call Mechanism (Detailed)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    SYSTEM CALL MECHANISM - DETAILED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    USER SPACE                                    KERNEL SPACE
    â•â•â•â•â•â•â•â•â•â•                                    â•â•â•â•â•â•â•â•â•â•â•â•
    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  C Application      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  int fd = open(     â”‚
â”‚    "/tmp/file.txt", â”‚
â”‚    O_RDONLY         â”‚
â”‚  );                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ 1. libc function call
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  glibc wrapper      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  open():            â”‚
â”‚    mov $2, %rax     â”‚  // syscall number for open = 2
â”‚    mov path, %rdi   â”‚  // first argument
â”‚    mov flags, %rsi  â”‚  // second argument
â”‚    mov mode, %rdx   â”‚  // third argument
â”‚    syscall          â”‚  // 2. SYSCALL instruction
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          â”‚              USER/KERNEL BOUNDARY (Ring 3 â†’ Ring 0)
          â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
          â”‚
          â”‚ 3. CPU saves state:
          â”‚    - RIP (return address) â†’ in special register
          â”‚    - RFLAGS â†’ in special register
          â”‚    - Switches to Ring 0 (kernel mode)
          â”‚    - Loads RSP from TSS (kernel stack)
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SYSTEM CALL ENTRY POINT (entry_SYSCALL_64)                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚  4. Saves registers on kernel stack:                                    â”‚
â”‚     push %rcx, %r11, %rax, %rdi, %rsi, %rdx, %r10, %r8, %r9            â”‚
â”‚                                                                         â”‚
â”‚  5. Verifies syscall number is valid (0 â‰¤ %rax < NR_syscalls)          â”‚
â”‚                                                                         â”‚
â”‚  6. Lookup in sys_call_table:                                          â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚     â”‚  sys_call_table[__NR_open] = sys_open          â”‚                 â”‚
â”‚     â”‚                                                â”‚                 â”‚
â”‚     â”‚  Index â”‚ Handler          â”‚ Description        â”‚                 â”‚
â”‚     â”‚  â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
â”‚     â”‚    0   â”‚ sys_read         â”‚ Read from fd       â”‚                 â”‚
â”‚     â”‚    1   â”‚ sys_write        â”‚ Write to fd        â”‚                 â”‚
â”‚     â”‚    2   â”‚ sys_open   â—„â”€â”€â”€â”€ â”‚ Open file          â”‚                 â”‚
â”‚     â”‚    3   â”‚ sys_close        â”‚ Close fd           â”‚                 â”‚
â”‚     â”‚   ...  â”‚ ...              â”‚ ...                â”‚                 â”‚
â”‚     â”‚  435   â”‚ sys_clone3       â”‚ Clone process      â”‚                 â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                         â”‚
â”‚  7. Calls sys_open(path, flags, mode)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  sys_open() - Kernel Implementation                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚                                                                         â”‚
â”‚  a) Copies path from user space to kernel space (copy_from_user)       â”‚
â”‚  b) Verifies permissions (can current user access this file?)          â”‚
â”‚  c) Looks up the file's inode in VFS                                   â”‚
â”‚  d) Allocates a new file descriptor in the process table               â”‚
â”‚  e) Creates the file structure for this open                           â”‚
â”‚  f) Returns fd (or negative error)                                     â”‚
â”‚                                                                         â”‚
â”‚  return fd;  // e.g. 3 (first 3: 0=stdin, 1=stdout, 2=stderr)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ 8. Result in %rax
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SYSTEM CALL EXIT                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚  9. Restores registers from kernel stack                               â”‚
â”‚  10. Checks if there are pending signals                               â”‚
â”‚  11. Executes SYSRET (or IRET)                                         â”‚
â”‚      - Switches back to Ring 3                                         â”‚
â”‚      - Restores RIP, RFLAGS, RSP                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         BACK IN USER SPACE
          â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  glibc wrapper      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  12. Checks %rax:   â”‚
â”‚     if (rax < 0)    â”‚
â”‚       errno = -rax; â”‚
â”‚       return -1;    â”‚
â”‚     return rax;     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Application        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  fd = 3             â”‚
â”‚  // Success!        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Diagram 2.2: System Call Categories

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    SYSTEM CALL CATEGORIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SYSTEM CALLS                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
        â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PROCESSES   â”‚       â”‚     FILES     â”‚       â”‚    MEMORY     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ fork()        â”‚       â”‚ open()        â”‚       â”‚ brk()         â”‚
â”‚ exec()        â”‚       â”‚ close()       â”‚       â”‚ mmap()        â”‚
â”‚ exit()        â”‚       â”‚ read()        â”‚       â”‚ munmap()      â”‚
â”‚ wait()        â”‚       â”‚ write()       â”‚       â”‚ mprotect()    â”‚
â”‚ clone()       â”‚       â”‚ lseek()       â”‚       â”‚ mlock()       â”‚
â”‚ getpid()      â”‚       â”‚ stat()        â”‚       â”‚ mremap()      â”‚
â”‚ getppid()     â”‚       â”‚ fstat()       â”‚       â”‚               â”‚
â”‚ nice()        â”‚       â”‚ dup()         â”‚       â”‚               â”‚
â”‚ kill()        â”‚       â”‚ pipe()        â”‚       â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚                       â”‚
        â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DIRECTORIES  â”‚       â”‚    NETWORK    â”‚       â”‚   DEVICES     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ mkdir()       â”‚       â”‚ socket()      â”‚       â”‚ ioctl()       â”‚
â”‚ rmdir()       â”‚       â”‚ bind()        â”‚       â”‚ select()      â”‚
â”‚ chdir()       â”‚       â”‚ listen()      â”‚       â”‚ poll()        â”‚
â”‚ getcwd()      â”‚       â”‚ accept()      â”‚       â”‚ epoll_*()     â”‚
â”‚ opendir()     â”‚       â”‚ connect()     â”‚       â”‚               â”‚
â”‚ readdir()     â”‚       â”‚ send()        â”‚       â”‚               â”‚
â”‚ link()        â”‚       â”‚ recv()        â”‚       â”‚               â”‚
â”‚ unlink()      â”‚       â”‚ shutdown()    â”‚       â”‚               â”‚
â”‚ rename()      â”‚       â”‚               â”‚       â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                               â”‚
        â–¼                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SIGNALS    â”‚                               â”‚     TIME      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ signal()      â”‚                               â”‚ time()        â”‚
â”‚ sigaction()   â”‚                               â”‚ gettimeofday()â”‚
â”‚ sigprocmask() â”‚                               â”‚ clock_gettime()
â”‚ sigsuspend()  â”‚                               â”‚ nanosleep()   â”‚
â”‚ sigpending()  â”‚                               â”‚ alarm()       â”‚
â”‚ sigwait()     â”‚                               â”‚ setitimer()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Solved Exercises

### Exercise 2.1: strace Analysis

Task: Analyse the output of `strace ls /tmp` and identify each syscall category.

```bash
$ strace ls /tmp 2>&1 | head -20

execve("/bin/ls", ["ls", "/tmp"], 0x7fff...) = 0
brk(NULL)                                = 0x55a8...
openat(AT_FDCWD, "/etc/ld.so.cache", O_RDONLY|O_CLOEXEC) = 3
fstat(3, {st_mode=S_IFREG|0644, ...})    = 0
mmap(NULL, 123456, PROT_READ, ...)       = 0x7f...
close(3)                                 = 0
openat(AT_FDCWD, "/lib/x86_64.../libc.so.6", O_RDONLY) = 3
read(3, "\177ELF...", 832)               = 832
close(3)                                 = 0
...
openat(AT_FDCWD, "/tmp", O_RDONLY|O_DIRECTORY) = 3
getdents64(3, /* 5 entries */, 32768)    = 152
write(1, "file1.txt  file2.txt\n", 22)   = 22
close(3)                                 = 0
exit_group(0)                            = ?
```

Solution:

| Syscall | Category | Purpose |
|---------|----------|---------|
| `execve` | Processes | Loads and executes the `/bin/ls` binary |
| `brk` | Memory | Allocates/deallocates heap |
| `openat` | Files | Opens file/directory |
| `fstat` | Files | Gets file metadata |
| `mmap` | Memory | Maps memory (loads libraries) |
| `close` | Files | Closes file descriptor |
| `read` | Files | Reads from file descriptor |
| `getdents64` | Directories | Reads directory entries |
| `write` | Files | Writes output to stdout (fd=1) |
| `exit_group` | Processes | Terminates the process |

---

### Exercise 2.2: EAT (Effective Access Time) Calculation

Problem: A system has:
- Memory access time: 100 ns
- Syscall overhead (userâ†”kernel transition): 500 ns
- Kernel processing time: 200 ns

Calculate the effective time for:
a) Direct memory access (local variable)
b) A `getpid()` syscall (no disc access)
c) A `read()` syscall that reads from cache

Solution:

```
a) Direct memory access:
   T = 100 ns
   (Only one RAM access)

b) getpid():
   T = overhead_userâ†’kernel + processing + overhead_kernelâ†’user
   T = 500 + 200 + 500 = 1200 ns
   
   (12x slower than memory access!)

c) read() from cache:
   T = overhead_userâ†’kernel + kernel_processing + cache_access + overhead_kernelâ†’user
   T = 500 + 200 + 100 + 500 = 1300 ns
   
   (Similar to getpid, just one additional memory access for cached data)
```

---

## Exam-Style Questions

### Multiple Choice Questions

2.1 What x86-64 instruction triggers a system call in modern Linux?
- a) int 0x80
- b) sysenter
- c) syscall âœ“
- d) trap

Answer: c) - `syscall` is the standard instruction on x86-64.

---

2.2 Where is the syscall number when the `syscall` instruction is executed?
- a) In memory
- b) On the stack
- c) In the %rdi register
- d) In the %rax register âœ“

Answer: d) - Linux convention: syscall number in %rax.

---

2.3 What does `fork()` return in the child process?
- a) The child's PID
- b) The parent's PID
- c) 0 âœ“
- d) -1

Answer: c) - The parent receives the child's PID; the child receives 0.

---

### Extended Answer Questions

2.4 (5p) Explain why system calls need to exist. Why can't applications access hardware directly?

Model answer:

System calls are necessary for several fundamental reasons:

1. Protection (2p):
   - Without syscalls, any application could access any memory area
   - A bug or malicious programme could corrupt other processes' data or the kernel's
   - Syscalls allow the kernel to verify permissions before each operation

2. Abstraction (1.5p):
   - Applications don't need to know hardware details
   - The same code works on different types of discs, network cards, etc.
   - The kernel provides a uniform interface (POSIX)

3. Coordination (1.5p):
   - Multiple processes want to access the same resource (disc, network)
   - The kernel serialises access and prevents conflicts
   - Ensures fairness in resource allocation

Concrete example: Without syscalls, two processes could write simultaneously to the same disc sector, corrupting each other's data.

---

# WEEK 3: Processes

## Detailed ASCII Diagrams

### Diagram 3.1: Complete State Diagram

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    PROCESS STATE DIAGRAM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                                    PROCESS CREATION
                                    (fork/exec)
                                         â”‚
                                         â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚                 â”‚
                               â”‚      NEW        â”‚
                               â”‚                 â”‚
                               â”‚  (PCB allocationâ”‚
                               â”‚   resources)    â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ admitted (scheduler accepts)
                                        â”‚
                                        â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¤              READY                   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚        â”‚                                      â”‚             â”‚
           â”‚        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚             â”‚
           â”‚        â”‚     â”‚    READY QUEUE          â”‚     â”‚             â”‚
           â”‚        â”‚     â”‚  â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”     â”‚     â”‚             â”‚
           â”‚        â”‚     â”‚  â”‚P2 â”‚â†’â”‚P5 â”‚â†’â”‚P3 â”‚â†’... â”‚     â”‚             â”‚
           â”‚        â”‚     â”‚  â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜     â”‚     â”‚             â”‚
           â”‚        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚             â”‚
           â”‚        â”‚                                      â”‚             â”‚
           â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
           â”‚                           â”‚                                 â”‚
           â”‚                           â”‚ dispatch                        â”‚
           â”‚                           â”‚ (scheduler selects)             â”‚
           â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                 â”‚
           â”‚     â”‚                     â”‚                                 â”‚
           â”‚     â”‚                     â–¼                                 â”‚
           â”‚     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
           â”‚     â”‚         â”‚                     â”‚                      â”‚
           â”‚     â”‚         â”‚      RUNNING        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
           â”‚     â”‚         â”‚                     â”‚     preemption       â”‚
           â”‚     â”‚         â”‚   (on CPU now)      â”‚   (timer interrupt,  â”‚
           â”‚     â”‚         â”‚                     â”‚    higher priority)  â”‚
           â”‚     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
           â”‚     â”‚                    â”‚                                 â”‚
           â”‚     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
           â”‚     â”‚      â”‚             â”‚             â”‚                   â”‚
           â”‚     â”‚      â–¼             â–¼             â–¼                   â”‚
           â”‚     â”‚  I/O request   terminate    child wait              â”‚
           â”‚     â”‚  (read/write)   (exit)      (fork)                  â”‚
           â”‚     â”‚      â”‚             â”‚             â”‚                   â”‚
           â”‚     â”‚      â”‚             â”‚             â”‚                   â”‚
           â”‚     â”‚      â–¼             â”‚             â–¼                   â”‚
           â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
           â”‚     â”‚ â”‚         â”‚        â”‚      â”‚   WAITING   â”‚           â”‚
           â”‚     â”‚ â”‚ WAITING â”‚        â”‚      â”‚  (for child)â”‚           â”‚
           â”‚     â”‚ â”‚ (I/O)   â”‚        â”‚      â”‚             â”‚           â”‚
           â”‚     â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
           â”‚     â”‚      â”‚             â”‚             â”‚                   â”‚
           â”‚     â”‚      â”‚ I/O         â”‚             â”‚ child exits       â”‚
           â”‚     â”‚      â”‚ complete    â”‚             â”‚ (SIGCHLD)        â”‚
           â”‚     â”‚      â”‚             â”‚             â”‚                   â”‚
           â”‚     â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
           â”‚                          â”‚                                 â”‚
           â”‚                          â–¼                                 â”‚
           â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
           â”‚              â”‚                     â”‚                       â”‚
           â”‚              â”‚    TERMINATED       â”‚                       â”‚
           â”‚              â”‚     (ZOMBIE)        â”‚                       â”‚
           â”‚              â”‚                     â”‚                       â”‚
           â”‚              â”‚  (waiting for       â”‚                       â”‚
           â”‚              â”‚   parent's wait())  â”‚                       â”‚
           â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
           â”‚                         â”‚                                  â”‚
           â”‚                         â”‚ parent calls wait()              â”‚
           â”‚                         â”‚ (reaps zombie)                   â”‚
           â”‚                         â–¼                                  â”‚
           â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
           â”‚              â”‚                     â”‚                       â”‚
           â”‚              â”‚       DEAD          â”‚                       â”‚
           â”‚              â”‚  (PCB released)     â”‚                       â”‚
           â”‚              â”‚                     â”‚                       â”‚
           â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
           â”‚                                                            â”‚
           â”‚                                                            â”‚
           â”‚              BLOCKED/WAITING QUEUE                         â”‚
           â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  Disc I/O: P7, P9, P12                 â”‚â”€â”€â”€â”˜
                          â”‚  Network:  P4, P8                       â”‚
                          â”‚  Pipe:     P6                           â”‚
                          â”‚  Sleep:    P10, P11                     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ event occurs
                                        â”‚ (I/O complete, signal, etc.)
                                        â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º moves to READY
```

### Diagram 3.2: fork() and Copy-on-Write

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    FORK() AND COPY-ON-WRITE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BEFORE FORK():
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Parent Process (PID: 1000)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Virtual Address Space                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 0xFFFF... â”‚ Kernel Space (shared)                   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 0x7FFF... â”‚ Stack    [var_a=5, var_b=10]           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚           â”‚                                         â”‚  â”‚
â”‚  â”‚           â”‚ (free)                                  â”‚  â”‚
â”‚  â”‚           â”‚                                         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 0x5555... â”‚ Heap     [malloc_data="Hello"]         â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 0x4000... â”‚ Data     [global_x=100]                â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 0x1000... â”‚ Text     [instructions...]             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                            â”‚
â”‚  Page Table:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ VPage   â”‚ Frame   â”‚ Permissions   â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚    0    â”‚   100   â”‚ R-X (text)    â”‚                    â”‚
â”‚  â”‚    1    â”‚   101   â”‚ RW- (data)    â”‚                    â”‚
â”‚  â”‚    2    â”‚   102   â”‚ RW- (heap)    â”‚                    â”‚
â”‚  â”‚   ...   â”‚   ...   â”‚ ...           â”‚                    â”‚
â”‚  â”‚  1023   â”‚   150   â”‚ RW- (stack)   â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Physical Memory
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frame 100: [text instructions]        â”‚
â”‚  Frame 101: [global_x=100]             â”‚
â”‚  Frame 102: [malloc_data="Hello"]      â”‚
â”‚  ...                                   â”‚
â”‚  Frame 150: [var_a=5, var_b=10]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

IMMEDIATELY AFTER FORK() - Copy-on-Write:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

         PARENT (PID: 1000)                    CHILD (PID: 1001)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page Table Parent             â”‚    â”‚  Page Table Child              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ VPage  â”‚ Frame â”‚ Perms   â”‚  â”‚    â”‚  â”‚ VPage  â”‚ Frame â”‚ Perms   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚   0    â”‚  100  â”‚ R-X     â”‚  â”‚    â”‚  â”‚   0    â”‚  100  â”‚ R-X     â”‚  â”‚
â”‚  â”‚   1    â”‚  101  â”‚ R-- CoW â”‚â—„â”€â”¼â”€â”€â”€â”€â”¼â”€â–ºâ”‚   1    â”‚  101  â”‚ R-- CoW â”‚  â”‚
â”‚  â”‚   2    â”‚  102  â”‚ R-- CoW â”‚â—„â”€â”¼â”€â”€â”€â”€â”¼â”€â–ºâ”‚   2    â”‚  102  â”‚ R-- CoW â”‚  â”‚
â”‚  â”‚  1023  â”‚  150  â”‚ R-- CoW â”‚â—„â”€â”¼â”€â”€â”€â”€â”¼â”€â–ºâ”‚  1023  â”‚  150  â”‚ R-- CoW â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                     â”‚
                â”‚         SHARED PAGES                â”‚
                â”‚    (marked Read-Only + CoW flag)    â”‚
                â–¼                                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Frame 100: [text] â”€â”€â”€â”€â”€â”€ Shared (R-X)           â”‚
        â”‚  Frame 101: [data] â”€â”€â”€â”€â”€â”€ Shared (CoW)           â”‚
        â”‚  Frame 102: [heap] â”€â”€â”€â”€â”€â”€ Shared (CoW)           â”‚
        â”‚  Frame 150: [stack] â”€â”€â”€â”€â”€ Shared (CoW)           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

AFTER CHILD WRITES (global_x = 200):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Child tries to write to page 1 (data segment)
2. Page Fault! (page is marked Read-Only)
3. Kernel sees the CoW flag
4. Kernel:
   a. Allocates a new frame (103)
   b. Copies content from frame 101 â†’ frame 103
   c. Updates child page table: page 1 â†’ frame 103 (RW-)
   d. Leaves parent page table: page 1 â†’ frame 101 (can now be RW-)
5. Child writes to frame 103

         PARENT (PID: 1000)                    CHILD (PID: 1001)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Page Table Parent             â”‚    â”‚  Page Table Child              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ VPage  â”‚ Frame â”‚ Perms   â”‚  â”‚    â”‚  â”‚ VPage  â”‚ Frame â”‚ Perms   â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚   0    â”‚  100  â”‚ R-X     â”‚  â”‚    â”‚  â”‚   0    â”‚  100  â”‚ R-X     â”‚  â”‚
â”‚  â”‚   1    â”‚  101  â”‚ RW-     â”‚  â”‚    â”‚  â”‚   1    â”‚  103  â”‚ RW-     â”‚  â”‚ â† COPIED!
â”‚  â”‚   2    â”‚  102  â”‚ R-- CoW â”‚â—„â”€â”¼â”€â”€â”€â”€â”¼â”€â–ºâ”‚   2    â”‚  102  â”‚ R-- CoW â”‚  â”‚
â”‚  â”‚  1023  â”‚  150  â”‚ R-- CoW â”‚â—„â”€â”¼â”€â”€â”€â”€â”¼â”€â–ºâ”‚  1023  â”‚  150  â”‚ R-- CoW â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        Physical Memory:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Frame 100: [text] â”€â”€â”€â”€â”€â”€ Shared                 â”‚
        â”‚  Frame 101: [global_x=100] â”€â”€ Parent only        â”‚
        â”‚  Frame 102: [heap] â”€â”€â”€â”€â”€â”€ Shared                 â”‚
        â”‚  Frame 103: [global_x=200] â”€â”€ Child only (NEW!)  â”‚
        â”‚  Frame 150: [stack] â”€â”€â”€â”€â”€ Shared                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Solved Exercises

### Exercise 3.1: Process Tree

Problem: What output does the following code produce?

```c
int main() {
    fork();
    fork();
    printf("X\n");
    return 0;
}
```

Solution:

```
Let's trace the execution:

Initially: 1 process (A)

After first fork():
  A (parent)
  â””â”€â”€ B (child)
  
  Total: 2 processes

After second fork() (executed by BOTH processes):
  A executes fork() â†’ creates C
  B executes fork() â†’ creates D
  
  A â”€â”€â”€â”€ (first fork) â”€â”€â”€â–º B
  â”‚                         â”‚
  â”‚ (second fork)           â”‚ (second fork)
  â–¼                         â–¼
  C                         D

Final tree:
       A
      / \
     B   C
     |
     D

Total: 4 processes

Each process executes printf("X\n"):
Output: X X X X (4 lines with X)

General formula: 2^n processes for n consecutive fork() calls
(if all forks succeed)
```

---

### Exercise 3.2: PCB Analysis

Problem: From the output below, identify the key information:

```bash
$ cat /proc/1234/status
Name:   python3
State:  S (sleeping)
Pid:    1234
PPid:   1100
Uid:    1000    1000    1000    1000
VmSize: 125000 kB
VmRSS:  45000 kB
Threads: 4
voluntary_ctxt_switches:        1523
nonvoluntary_ctxt_switches:     89
```

Solution:

| Field | Value | Interpretation |
|-------|-------|----------------|
| Name | python3 | Executable name |
| State | S (sleeping) | Process is waiting (blocked on I/O or sleep) |
| Pid | 1234 | Process ID |
| PPid | 1100 | Parent's PID |
| Uid | 1000 | User ID (real, effective, saved, fs) - all 1000 |
| VmSize | 125000 kB (~122 MB) | Total virtual memory allocated |
| VmRSS | 45000 kB (~44 MB) | Physical memory actually used (Resident Set) |
| Threads | 4 | Number of threads |
| voluntary_ctxt_switches | 1523 | How many voluntary context switches (e.g. waiting on I/O) |
| nonvoluntary_ctxt_switches | 89 | How many preemptions (timer interrupt, higher priority) |

Observations:
- The process uses only 36% of allocated virtual memory (45/125 MB)
- The voluntary/nonvoluntary ratio (17:1) suggests an I/O-bound process
- 4 threads in a single Python process

---

## Exam-Style Questions

3.1 (Multiple Choice) What value does `fork()` return in the child process?
- a) The child's PID
- b) The parent's PID
- c) 0 âœ“
- d) -1

---

3.2 (Multiple Choice) A zombie process is:
- a) A process blocked waiting for I/O
- b) A terminated process whose PCB has not yet been released âœ“
- c) A process consuming 100% CPU
- d) A process without a parent

---

3.3 (5p) Explain the Copy-on-Write mechanism and why it is essential for fork() efficiency.

Model answer:

What is CoW? (1p)
Copy-on-Write is an optimisation technique that defers copying memory pages until one of the copies tries to write to the page.

How does it work? (2p)
1. At fork(), the kernel does NOT copy the memory pages
2. Both processes share the same physical frames
3. Pages are marked Read-Only (even if they were RW)
4. On first write â†’ Page Fault â†’ Kernel copies the page â†’ Updates page tables

Why is it essential? (2p)
- Traditional fork() copied the entire memory (~100+ MB) = slow
- With CoW, fork() only copies page tables (~KB) = fast
- Many child processes do exec() immediately â†’ wouldn't have used the copied data
- Code pages (text segment) are never copied (read-only anyway)

Concrete example: The shell does fork() + exec() for each command. Without CoW, it would copy tens of MB each time. With CoW, it copies only a few KB.

---

# WEEK 4: Scheduling

## Detailed ASCII Diagrams

### Diagram 4.1: Visual Algorithm Comparison

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              VISUAL COMPARISON - SCHEDULING ALGORITHMS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Processes: P1(burst=8), P2(burst=4), P3(burst=2), P4(burst=1)
All arrive at t=0, in order P1, P2, P3, P4

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FCFS (First-Come, First-Served):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Timeline:
0         5         10        15
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                              â”‚
â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”
â”‚       P1       â”‚   P2   â”‚ P3 â”‚P4â”‚
â”‚    (burst=8)   â”‚(burst=4â”‚(2) â”‚1 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”˜
0                8       12   14 15

Metrics:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Wait    â”‚ Turnaround â”‚ Response    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    0    â”‚     8      â”‚      0      â”‚
â”‚   P2   â”‚    8    â”‚    12      â”‚      8      â”‚
â”‚   P3   â”‚   12    â”‚    14      â”‚     12      â”‚
â”‚   P4   â”‚   14    â”‚    15      â”‚     14      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚   8.5   â”‚   12.25    â”‚     8.5     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SJF (Shortest Job First):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Order by burst: P4(1) < P3(2) < P2(4) < P1(8)

Timeline:
0         5         10        15
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â–¼                              â–¼
â”Œâ”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚P4â”‚ P3 â”‚   P2   â”‚       P1       â”‚
â”‚1 â”‚ 2  â”‚   4    â”‚       8        â”‚
â””â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0  1    3        7               15

Metrics:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Wait    â”‚ Turnaround â”‚ Response    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    7    â”‚    15      â”‚      7      â”‚
â”‚   P2   â”‚    3    â”‚     7      â”‚      3      â”‚
â”‚   P3   â”‚    1    â”‚     3      â”‚      1      â”‚
â”‚   P4   â”‚    0    â”‚     1      â”‚      0      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚  2.75   â”‚    6.5     â”‚    2.75     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Improvement vs FCFS: Wait time reduced from 8.5 to 2.75 (â†“68%!)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ROUND ROBIN (Quantum = 2):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Detailed timeline:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ t=0:  Ready queue: [P1, P2, P3, P4]                                     â”‚
â”‚       â†’ P1 runs (2 of 8)                                                â”‚
â”‚                                                                          â”‚
â”‚ t=2:  Ready queue: [P2, P3, P4, P1]  (P1 preempted, sent to back)      â”‚
â”‚       â†’ P2 runs (2 of 4)                                                â”‚
â”‚                                                                          â”‚
â”‚ t=4:  Ready queue: [P3, P4, P1, P2]                                     â”‚
â”‚       â†’ P3 runs (2 of 2) â†’ FINISHED                                     â”‚
â”‚                                                                          â”‚
â”‚ t=6:  Ready queue: [P4, P1, P2]                                         â”‚
â”‚       â†’ P4 runs (1 of 1) â†’ FINISHED                                     â”‚
â”‚                                                                          â”‚
â”‚ t=7:  Ready queue: [P1, P2]                                             â”‚
â”‚       â†’ P1 runs (2 of 6 remaining)                                      â”‚
â”‚                                                                          â”‚
â”‚ t=9:  Ready queue: [P2, P1]                                             â”‚
â”‚       â†’ P2 runs (2 of 2) â†’ FINISHED                                     â”‚
â”‚                                                                          â”‚
â”‚ t=11: Ready queue: [P1]                                                 â”‚
â”‚       â†’ P1 runs (2 of 4 remaining)                                      â”‚
â”‚                                                                          â”‚
â”‚ t=13: Ready queue: [P1]                                                 â”‚
â”‚       â†’ P1 runs (2 of 2) â†’ FINISHED                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Gantt Chart:
0    2    4    6  7    9   11   13   15
â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ P1 â”‚ P2 â”‚ P3 â”‚P4â”‚ P1 â”‚ P2 â”‚ P1 â”‚ P1 â”‚
â”‚(2) â”‚(2) â”‚(2) â”‚1 â”‚(2) â”‚(2) â”‚(2) â”‚(2) â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Metrics:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Wait    â”‚ Turnaround â”‚ Response    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    7    â”‚    15      â”‚      0      â”‚ â† Excellent response!
â”‚   P2   â”‚    7    â”‚    11      â”‚      2      â”‚
â”‚   P3   â”‚    4    â”‚     6      â”‚      4      â”‚
â”‚   P4   â”‚    6    â”‚     7      â”‚      6      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚    6    â”‚   9.75     â”‚      3      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FINAL COMPARISON:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Algorithm   â”‚ Avg Wait  â”‚ Avg Turnar.  â”‚ Avg Response â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     FCFS      â”‚    8.5    â”‚    12.25     â”‚     8.5      â”‚
â”‚     SJF       â”‚   2.75    â”‚     6.5      â”‚    2.75      â”‚ â† Best wait
â”‚  RR (q=2)     â”‚    6.0    â”‚    9.75      â”‚     3.0      â”‚ â† Best response
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Observations:
â€¢ SJF minimises waiting time (theoretically optimal)
â€¢ RR offers the best response time (interactivity)
â€¢ FCFS has convoy effect (P4 with burst=1 waits 14 units!)
```

### Diagram 4.2: MLFQ (Multi-Level Feedback Queue)

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    MULTI-LEVEL FEEDBACK QUEUE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MLFQ STRUCTURE                                  â”‚
â”‚                                                                         â”‚
â”‚  Priority                                                               â”‚
â”‚  HIGH                                                                   â”‚
â”‚    â”‚                                                                    â”‚
â”‚    â”‚   Queue 0: Quantum = 8ms, RR                                      â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚   â”‚  â—‹â”€â”€â—‹â”€â”€â—‹â”€â”€â—‹     (newly created/interactive)    â”‚              â”‚
â”‚    â”‚   â”‚  P1 P7 P12     Maximum priority                â”‚              â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”‚         â”‚                                                          â”‚
â”‚    â”‚         â”‚ Uses entire quantum? â†’ Demote!                          â”‚
â”‚    â”‚         â–¼                                                          â”‚
â”‚    â”‚   Queue 1: Quantum = 16ms, RR                                     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚   â”‚  â—‹â”€â”€â—‹â”€â”€â—‹        ("medium" processes)           â”‚              â”‚
â”‚    â”‚   â”‚  P3 P5 P9                                      â”‚              â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”‚         â”‚                                                          â”‚
â”‚    â”‚         â”‚ Uses entire quantum? â†’ Demote!                          â”‚
â”‚    â”‚         â–¼                                                          â”‚
â”‚    â”‚   Queue 2: Quantum = 32ms, RR                                     â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚   â”‚  â—‹â”€â”€â—‹           (CPU-bound processes)          â”‚              â”‚
â”‚    â”‚   â”‚  P2 P6                                         â”‚              â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â”‚         â”‚                                                          â”‚
â”‚    â”‚         â–¼                                                          â”‚
â”‚    â”‚   Queue 3: FCFS (lowest priority)                                 â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚   â”‚  â—‹â”€â”€â—‹â”€â”€â—‹â”€â”€â—‹â”€â”€â—‹  (batch jobs)                   â”‚              â”‚
â”‚    â”‚   â”‚  P4 P8 P10 P11 P13                             â”‚              â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚    â–¼                                                                    â”‚
â”‚  LOW                                                                    â”‚
â”‚                                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚  MLFQ RULES:                                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚                                                                         â”‚
â”‚  Rule 1: If Priority(A) > Priority(B) â†’ A runs                         â”‚
â”‚  Rule 2: If Priority(A) = Priority(B) â†’ RR between them                â”‚
â”‚  Rule 3: New process â†’ Queue 0 (maximum priority)                      â”‚
â”‚  Rule 4a: If uses entire quantum â†’ demote one queue                    â”‚
â”‚  Rule 4b: If yields CPU (I/O) â†’ stays in same queue                    â”‚
â”‚  Rule 5: PRIORITY BOOST every S seconds                                â”‚
â”‚          (move ALL processes to Queue 0)                               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MLFQ TIMELINE EXAMPLE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Process A: Interactive (does I/O frequently, short burst)
Process B: CPU-bound (continuous computation)

t=0:   Both in Q0 (newly created)
       A runs 3ms, does I/O â†’ stays in Q0 âœ“
       B runs 8ms (entire quantum) â†’ demotes to Q1 â†“

t=8:   A (Q0) has priority > B (Q1)
       A runs 2ms, does I/O â†’ stays in Q0 âœ“

t=10:  A does I/O, B (Q1) runs
       B runs 16ms (entire Q1 quantum) â†’ demotes to Q2 â†“

t=26:  A returns from I/O
       A (Q0) has priority > B (Q2)
       A runs...

Result: A (interactive) always has fast response!
        B (batch) runs when A doesn't need CPU.

Visual timeline:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    A    â”‚         B          â”‚  A â”‚        B        â”‚  A â”‚     B     â”‚
â”‚ (Q0,3ms)â”‚     (Q0â†’Q1,8ms)    â”‚(Q0)â”‚   (Q1â†’Q2,16ms)  â”‚(Q0)â”‚  (Q2...)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0         3                    11  13                 29   31

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STARVATION PROBLEM AND BOOST SOLUTION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Without boost:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Q0: [I1, I2, I3, ...] â† Many interactive processes                    â”‚
â”‚  Q1: [...]                                                              â”‚
â”‚  Q2: [...]                                                              â”‚
â”‚  Q3: [B1, B2] â† Batch processes NEVER GET CPU! (starvation)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

With Priority Boost (every S = 1 second):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  t=1s: BOOST! All processes â†’ Q0                                       â”‚
â”‚  Q0: [I1, I2, I3, B1, B2, ...] â† B1, B2 also get a chance             â”‚
â”‚  Q1: []                                                                 â”‚
â”‚  Q2: []                                                                 â”‚
â”‚  Q3: []                                                                 â”‚
â”‚                                                                         â”‚
â”‚  B1, B2 run 8ms each, then demote again...                             â”‚
â”‚  But every second they get another chance!                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Solved Exercises

### Exercise 4.1: Complete Scheduling Calculation

Problem: Calculate metrics for the following processes using FCFS and SJF:

| Process | Arrival Time | Burst Time |
|---------|--------------|------------|
| P1 | 0 | 7 |
| P2 | 2 | 4 |
| P3 | 4 | 1 |
| P4 | 5 | 4 |

FCFS Solution:

```
Processes are served in arrival order: P1, P2, P3, P4

Gantt Chart:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      P1       â”‚   P2   â”‚P3 â”‚   P4   â”‚
â”‚     (7)       â”‚  (4)   â”‚(1)â”‚  (4)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0               7       11  12       16

Calculations:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Arrival â”‚ Completion â”‚ Turnaround     â”‚ Waiting    â”‚
â”‚        â”‚         â”‚            â”‚ (CT - AT)      â”‚ (TT - BT)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    0    â”‚     7      â”‚  7 - 0 = 7     â”‚ 7 - 7 = 0  â”‚
â”‚   P2   â”‚    2    â”‚    11      â”‚ 11 - 2 = 9     â”‚ 9 - 4 = 5  â”‚
â”‚   P3   â”‚    4    â”‚    12      â”‚ 12 - 4 = 8     â”‚ 8 - 1 = 7  â”‚
â”‚   P4   â”‚    5    â”‚    16      â”‚ 16 - 5 = 11    â”‚ 11 - 4 = 7 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚    -    â”‚     -      â”‚     8.75       â”‚    4.75    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

SJF Solution (Non-Preemptive):

```
At t=0: Only P1 available â†’ P1 runs
At t=7: P2(4), P3(1), P4(4) available â†’ P3 shortest
At t=8: P2(4), P4(4) available â†’ P2 (arrived first)
At t=12: Only P4 â†’ P4 runs

Gantt Chart:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      P1       â”‚P3 â”‚   P2   â”‚   P4   â”‚
â”‚     (7)       â”‚(1)â”‚  (4)   â”‚  (4)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0               7   8       12       16

Calculations:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Arrival â”‚ Completion â”‚ Turnaround     â”‚ Waiting    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    0    â”‚     7      â”‚  7 - 0 = 7     â”‚ 7 - 7 = 0  â”‚
â”‚   P2   â”‚    2    â”‚    12      â”‚ 12 - 2 = 10    â”‚ 10 - 4 = 6 â”‚
â”‚   P3   â”‚    4    â”‚     8      â”‚  8 - 4 = 4     â”‚ 4 - 1 = 3  â”‚
â”‚   P4   â”‚    5    â”‚    16      â”‚ 16 - 5 = 11    â”‚ 11 - 4 = 7 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚    -    â”‚     -      â”‚      8.0       â”‚    4.0     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Comparison:
- FCFS: Avg Wait = 4.75, Avg Turnaround = 8.75
- SJF:  Avg Wait = 4.0,  Avg Turnaround = 8.0
- SJF reduces waiting time by 16%
```

---

### Exercise 4.2: Round Robin with Arrival Times

Problem: Quantum = 3, calculate for:

| Process | Arrival | Burst |
|---------|---------|-------|
| P1 | 0 | 5 |
| P2 | 1 | 3 |
| P3 | 2 | 1 |
| P4 | 3 | 2 |
| P5 | 4 | 3 |

Solution:

```
Step-by-step timeline:

t=0: Ready=[P1]
     P1 runs 3ms (remaining: 2)
     
t=3: Ready=[P2, P3, P4, P1] (P2,P3,P4 arrived in the meantime; P1 at end)
     P2 runs 3ms (remaining: 0) â†’ DONE
     
t=6: Ready=[P3, P4, P1, P5] (P5 arrived at t=4)
     P3 runs 1ms (remaining: 0) â†’ DONE
     
t=7: Ready=[P4, P1, P5]
     P4 runs 2ms (remaining: 0) â†’ DONE
     
t=9: Ready=[P1, P5]
     P1 runs 2ms (remaining: 0) â†’ DONE
     
t=11: Ready=[P5]
      P5 runs 3ms (remaining: 0) â†’ DONE
      
t=14: ALL COMPLETE

Gantt Chart:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   P1    â”‚   P2    â”‚P3 â”‚ P4 â”‚ P1 â”‚   P5    â”‚
â”‚  (3)    â”‚   (3)   â”‚(1)â”‚ (2)â”‚ (2)â”‚   (3)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
0         3         6   7    9   11        14

Metrics:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Processâ”‚ Arrival â”‚ Completion â”‚ Turnaround     â”‚ Waiting    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   P1   â”‚    0    â”‚    11      â”‚ 11 - 0 = 11    â”‚ 11 - 5 = 6 â”‚
â”‚   P2   â”‚    1    â”‚     6      â”‚  6 - 1 = 5     â”‚  5 - 3 = 2 â”‚
â”‚   P3   â”‚    2    â”‚     7      â”‚  7 - 2 = 5     â”‚  5 - 1 = 4 â”‚
â”‚   P4   â”‚    3    â”‚     9      â”‚  9 - 3 = 6     â”‚  6 - 2 = 4 â”‚
â”‚   P5   â”‚    4    â”‚    14      â”‚ 14 - 4 = 10    â”‚ 10 - 3 = 7 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AVG   â”‚    -    â”‚     -      â”‚      7.4       â”‚    4.6     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Exam-Style Questions

4.1 (Multiple Choice) Which scheduling algorithm is optimal for minimising average waiting time?
- a) FCFS
- b) SJF âœ“
- c) Round Robin
- d) MLFQ

---

4.2 (Multiple Choice) Belady's Anomaly states that:
- a) SJF can cause starvation
- b) With FIFO, more pages can cause more page faults âœ“
- c) Round Robin has high context switch overhead
- d) Priority scheduling is unfair

---

4.3 (5p) Given processes P1(burst=6), P2(burst=3), P3(burst=8), P4(burst=3), all arriving at t=0.

a) Calculate avg waiting time for FCFS (order P1,P2,P3,P4)
b) Calculate avg waiting time for SJF
c) Which algorithm is better and by how much?
d) If P3 is an interactive process, would SJF be a good choice? Justify.

Answer:

```
a) FCFS:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
   â”‚   P1   â”‚ P2  â”‚    P3    â”‚ P4  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
   0        6     9         17    20
   
   Wait times: P1=0, P2=6, P3=9, P4=17
   Avg = (0+6+9+17)/4 = 8.0

b) SJF (order: P2,P4,P1,P3 - burst 3,3,6,8):
   â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ P2  â”‚ P4  â”‚   P1   â”‚    P3    â”‚
   â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   0     3     6       12         20
   
   Wait times: P2=0, P4=3, P1=6, P3=12
   Avg = (0+3+6+12)/4 = 5.25

c) SJF is better: 8.0 - 5.25 = 2.75 units less
   Improvement: 2.75/8.0 = 34%

d) NO! P3 (burst=8, the longest) would always be last.
   Response time P3 with SJF = 12 (the highest!)
   For interactive processes, Round Robin or MLFQ would be preferable.
   MLFQ: P3 would start in Q0 with high priority, receiving a time slice quickly.
```

---

4.4 (7p) Explain the MLFQ algorithm completely, including:
a) Structure (number of queues, quantum for each)
b) Transition rules between queues
c) The starvation problem and how it solves it
d) Why MLFQ approximates SJF without knowing the burst?

Model answer:

```
a) Typical structure (3 points):
   - 3-4 queues with different priorities
   - Q0: Small quantum (8ms), maximum priority
   - Q1: Medium quantum (16ms)
   - Q2: Large quantum (32ms)
   - Q3: FCFS, minimum priority
   
   Processing: Always runs from the highest priority queue
   that has ready processes.

b) Transition rules (2 points):
   - NEW process â†’ Q0 (benefit of the doubt)
   - Uses ENTIRE quantum â†’ demotes one queue (it's CPU-bound)
   - Yields CPU before quantum (I/O) â†’ stays in same queue
   - Uses total allocated CPU in a window â†’ demotes

c) Starvation and the solution (1 point):
   Problem: Processes in low queues don't get CPU if there are always
            processes in high queues
   Solution: PRIORITY BOOST - every S seconds, move ALL processes
            to Q0. Guarantees that each process eventually gets CPU.

d) SJF approximation (1 point):
   - Processes with short burst finish in Q0 â†’ SJF-like behaviour
   - Processes with long burst demote â†’ run with lower priority
   - Result: Short processes finish first, without knowing the burst
   - MLFQ "learns" from the process's past behaviour
```

---

*Continued in the next file with Weeks 5-8...*

---

*Materials developed by Revolvix for ASE Bucharest - CSIE*
