<!-- RO: TRADUS ȘI VERIFICAT -->
@startuml
!theme plain
skinparam backgroundColor #FEFEFE
skinparam defaultFontName DejaVu Sans
skinparam defaultFontSize 10

title Comparison: FAT vs inode Allocation (ext4)
caption Course 12: File System Part 2 — Allocation Methods

left to right direction

package "**FAT (File Allocation Table)**" as FAT_PKG #LightBlue {
  rectangle "Directory Entry" as DE_FAT #White {
    rectangle "filename.txt\nstart: 5\nsize: 10KB" as entry_fat
  }
  
  rectangle "FAT Table\n(in memory)" as FAT_TABLE #LightYellow {
    rectangle "[5]→7\n[6]→EOF\n[7]→9\n[8]→free\n[9]→6" as fat_entries
  }
  
  rectangle "Data Blocks" as DATA_FAT #LightGreen {
    rectangle "5 | 7 | 9 | 6" as blocks_fat
  }
  
  entry_fat -down-> FAT_TABLE : "index\nfirst block"
  FAT_TABLE -down-> DATA_FAT : "chain:\n5→7→9→6→EOF"
}

package "**inode (ext4)**" as INODE_PKG #LightCoral {
  rectangle "Directory Entry" as DE_INODE #White {
    rectangle "filename.txt\ninode: 42" as entry_inode
  }
  
  rectangle "inode #42" as INODE #LightYellow {
    rectangle "size: 10KB\nmode: 0644\ndirect[0]: 100\ndirect[1]: 105\n..." as inode_data
  }
  
  rectangle "Data Blocks" as DATA_INODE #LightGreen {
    rectangle "100 | 105 | ..." as blocks_inode
  }
  
  entry_inode -down-> INODE : "lookup\ninode #"
  INODE -down-> DATA_INODE : "direct\npointers"
}

note bottom of FAT_PKG
  **FAT Advantages:**
  ✓ Simplicity
  ✓ Universal compatibility (USB, SD)
  ✓ Easy to repair
  
  **FAT Disadvantages:**
  ✗ FAT must be in RAM (overhead)
  ✗ Sequential access to find block
  ✗ Severe fragmentation
  ✗ No permissions/owner
  ✗ 4GB/file limit (FAT32)
end note

note bottom of INODE_PKG
  **inode Advantages:**
  ✓ Fast O(1) access via direct pointers
  ✓ Per-file metadata (permissions, timestamps)
  ✓ Native hard links
  ✓ Extents for large files (ext4)
  ✓ Journal for consistency
  
  **Disadvantages:**
  ✗ Implementation complexity
  ✗ Fixed inode count limit (set at format)
  ✗ Overhead for very small files
end note

@enduml
